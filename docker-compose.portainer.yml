services:
  backend:
    image: ghcr.io/${GHCR_OWNER}/orquestrador-backend:${IMAGE_TAG:-latest}
    environment:
      NODE_ENV: production
      PORT: "4000"
    volumes:
      - orquestrador_data:/app/apps/backend/data
    networks:
      - orquestrador_net
    deploy:
      restart_policy:
        condition: on-failure

  frontend:
    image: ghcr.io/${GHCR_OWNER}/orquestrador-frontend:${IMAGE_TAG:-latest}
    ports:
      - "8080:80"
    networks:
      - orquestrador_net
    deploy:
      restart_policy:
        condition: on-failure

volumes:
  orquestrador_data:

networks:
  orquestrador_net:
    driver: overlay
